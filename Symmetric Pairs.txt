Symmetric Pairs(ORACLE)


SELECT DISTINCT X, Y
FROM (
SELECT T0.X, T0.Y
FROM FUNCTIONS T0
INNER JOIN(
SELECT T1.X, T1.Y, T2.SUM_XY
FROM (
SELECT X, Y, X+Y AS S_XY
FROM FUNCTIONS) T1
INNER JOIN
(SELECT X+Y AS SUM_XY, COUNT(X+Y) AS COUNT_SAME
FROM FUNCTIONS 
GROUP BY X+Y
HAVING COUNT(X+Y) > 1) T2
ON T1.S_XY = T2.SUM_XY) T3
ON T0.X= T3.Y AND T0.Y = T3.X)
WHERE X<Y OR X=Y
ORDER BY X;