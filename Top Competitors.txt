Top Competitors(Oracle)


SELECT HACKER_ID, NAME
FROM(
SELECT HACKER_ID, NAME, COUNT(CHALLENGE_ID) AS COUNT_C
FROM(
SELECT T2.HACKER_ID, T2.NAME, T2.CHALLENGE_ID
FROM(
SELECT T1.HACKER_ID, T1.NAME, T1.SCORE, T1.CHALLENGE_ID, C.DIFFICULTY_LEVEL
FROM (
SELECT H.HACKER_ID, H.NAME, S.CHALLENGE_ID, S.SCORE
FROM HACKERS H
JOIN SUBMISSIONS S
ON H.HACKER_ID = S.HACKER_ID) T1
JOIN CHALLENGES C
ON T1.CHALLENGE_ID = C.CHALLENGE_ID) T2
JOIN DIFFICULTY D
ON T2.DIFFICULTY_LEVEL = D.DIFFICULTY_LEVEL
WHERE T2.SCORE = D.SCORE)
HAVING COUNT(CHALLENGE_ID) > 1
GROUP BY HACKER_ID, NAME
ORDER BY COUNT_C DESC, HACKER_ID ASC);