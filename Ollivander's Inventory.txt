Ollivander's Inventory(ORACLE)

SELECT T1.ID, T2.AGE, T2.MIN_PRICE, T2.POWER
FROM WANDS T1
INNER JOIN
(SELECT MIN(W.COINS_NEEDED) AS MIN_PRICE, W.POWER, P.AGE, P.CODE
FROM WANDS W
INNER JOIN WANDS_PROPERTY P
ON W.CODE = P.CODE
WHERE P.IS_EVIL = 0
GROUP BY W.POWER, P.AGE, P.CODE) T2
ON T1.CODE = T2.CODE AND T1.POWER = T2.POWER AND T1.COINS_NEEDED = T2.MIN_PRICE
ORDER BY T2.POWER DESC, T2.AGE DESC;